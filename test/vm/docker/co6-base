# Base Container
FROM centos:6.7

# Install SSH
RUN yum -y install openssh-server openssh-clients

# Add PostgreSQL packages
RUN rpm -ivh http://yum.postgresql.org/9.4/redhat/rhel-6-x86_64/pgdg-centos94-9.4-1.noarch.rpm

# Create test group
RUN groupadd -g6000 admin
RUN yum -y install sudo
RUN echo '%admin        ALL=(ALL)       NOPASSWD: ALL' > /etc/sudoers.d/admin
RUN sed -i 's/^Defaults    requiretty$/\# Defaults    requiretty/' /etc/sudoers

# Create test user
RUN adduser -gadmin -u6000 -n vagrant

# Start SSH when container starts
ENTRYPOINT service ssh restart && bash
